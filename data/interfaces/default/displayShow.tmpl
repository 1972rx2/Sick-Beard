#from sickbeard import tvapi, tvclasses
#from sickbeard.tvapi.tvapi_main import getTVShow
#from sickbeard.tvapi import tvapi_classes, safestore

#import sickbeard
#from sickbeard.common import *

#import os.path
#import datetime

#set $tvdb_id = 80349
#set $show = $getTVShow($tvdb_id)

#set global $title = $show.show_data.name
#set global $header = '<a href="http://thetvdb.com/?tab=series&amp;id=%d" target="_new">%s</a>' % ($show.tvdb_id, $show.show_data.name)

<!--#set global $topmenu="home"#-->
#include $os.path.join($sickbeard.PROG_DIR, "data/interfaces/default/inc_top.tmpl")

<input type="hidden" id="sbRoot" value="$sbRoot">

<script type="text/javascript" src="$sbRoot/js/displayShow.js"></script>
<script type="text/javascript" src="$sbRoot/js/plotTooltip.js"></script>

Airs: show.airs on $show.show_data.network<br />
Status: $show.show_data.status<br />

#if $showLoc[1]:
Location: $showLoc[0]
#else:
<span style="color: red;">Location: $showLoc[0]</span> (dir is missing)
#end if
<br />

Quality: #if $show.quality then $qualityStrings[int($show.quality)] else "?"#<br />
Season Folders: <img src="$sbRoot/images/#if $show.seasonfolders == 1 then "yes.gif\" alt=\"Y" else "no.gif\" alt=\"N"#" width="16" height="16"><br />

Active: <img src="$sbRoot/images/#if not $show.paused then "yes.gif\" alt=\"Y" else "no.gif\" alt=\"N"#" width="16" height="16"><br />

<br />

Change selected episodes to 
<select id="statusSelect">
#for $curStatus in ($BACKLOG, $DISCBACKLOG, $MISSED, $SKIPPED, $DOWNLOADED)
<option value="$curStatus">$sickbeard.statusStrings[$curStatus]
#end for
</select>
<input type="hidden" id="showID" value="$show.tvdb_id">
<input type="button" id="changeStatus" value="Go"><br />
<br />
<b>NOTE:</b> Episodes can only be changed to "Downloaded" if they are currently "Predownloaded" or "Snatched (Proper)".<br />
All other statuses will automatically update to Downloaded on a show refresh.<br />

#set $curSeason = -1
#set $odd = 0

<table class="sickbeardTable">

#set $epList = $safestore.safe_list($sickbeard.storeManager.safe_store("find", tvapi_classes.TVEpisodeData))
$epList.sort(lambda x, y: ($x.season*1000 + $x.episode) - ($y.season*1000 + $y.episode), reverse=True)
#for $epData in $epList:

  #if int($epData.season) != $curSeason:
  <tr class="seasonheader">
    <td colspan=8>
    <br />
    <h2>#if $epData.season == 0 then "Specials" else "Season "+str($epData.season)#
    <!--(<a href="setStatus/?show=$show.tvdb_id&season=$epData.season&status=$BACKLOG">add to backlog</a>)
    (<a href="setStatus/?show=$show.tvdb_id&season=$epData.season"&status=$DISCBACKLOG">add to disc backlog</a>)-->
    <br />
    </h2></td>
  </tr>
  <tr><th width="1%"><input type="checkbox" class="seasonCheck" id="$epData.season"></th><th>NFO</th><th>TBN</th><th>Episode</th><th>Name</th><th>Airdate</th><th>Filename</th><th>Status</th><th>Actions</th></tr>
        #set $curSeason = int($epData.season)
    #end if    

    #set $odd = not $odd#
  <tr class="#if $odd then "odd" else "even"#Line">
    <td width="1%">
#if int($epData.ep_obj.status) != $UNAIRED
      <input type="checkbox" class="epCheck" id="<%=str(epData.season)+'x'+str(epData.episode)%>" name="<%=str(epData.season) +"x"+str(epData.episode) %>">
#end if
    </td>
    <td align="center"><a name="<%=str(epData.season)+"x"+str(epData.episode)%>"></a><img src="$sbRoot/images/#if $epData.ep_obj.hasnfo == 1 then "yes.gif\" alt=\"Y" else "no.gif\" alt=\"N"#" width="16" height="16"></td>
    <td align="center"><img src="$sbRoot/images/#if $epData.ep_obj.hastbn == 1 then "yes.gif\" alt=\"Y" else "no.gif\" alt=\"N"#" width="16" height="16"></td>
    <td align="center">$epData.episode</td>
    <td>
        $epData.name
        #if $epData.description:
        <img src="$sbRoot/images/info.png" height="16" class="plotInfo" id="plot_info_$show.tvdb_id<%="_"+str(epData.season)+"_"+str(epData.episode)%>" />
        #end if
    </td>
    <td align="center">#if $epData.aired == 1 then "never" else $epData.aired#</td>
    <td>#if $epData.ep_obj.location then $os.path.basename($epData.ep_obj.location) else ""#</td>
    <td>$statusStrings[int($epData.ep_obj.status)]</td>
    <td align="center">
    #if int($epData.season) != 0: 
    <a href="searchEpisode?show=$show.tvdb_id&season=$epData.season&episode=$epData.episode">search</a>
    #end if
    </td>
   <tr>
   
#end for            
</table><br /><br />
            

#include $os.path.join($sickbeard.PROG_DIR, "data/interfaces/default/inc_bottom.tmpl")
